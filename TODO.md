# LabPro TODO

**Дата обновления:** 09.02.2026
**Статус:** Фаза 17 — Мониторинг оборудования, справочники, складской учёт

---

## Завершено (Фазы 1-14)

- [x] SQL-миграция — синхронизация schema.sql с кодом
- [x] API-функции — исправлены все расхождения с БД
- [x] Формы операций — Observe, Feed, Passage, Freeze, Thaw, Dispose
- [x] Карточки сущностей — Culture, Lot, Container, Bank, Donor
- [x] Списки и формы — все модули
- [x] Дашборд — статистика, задачи, уведомления
- [x] Бизнес-логика — авто-задачи, FEFO, авто-закрытие лотов
- [x] QR-сканер — парсинг всех типов кодов
- [x] Документы — Worksheet, Culture Passport
- [x] Чистка — mock-data удалён, credentials из env, мобильное меню, Toaster
- [x] Тестирование багфиксов — redirect, container_status, disposed protection
- [x] Доработка форм — пассаж (5 шагов), создание культуры (multi-container), инвентарь
- [x] Контаминация — авто-карантин, уведомления, Alert на карточке культуры
- [x] Объёмы сред — volume inputs в пассаже, operation_media.quantity_ml
- [x] Множественные контейнеры — container_groups[] в пассаже
- [x] Навигация — Склад (/inventory) + Справочники (/references) раздельно
- [x] Per-container media+volume — индивидуальное кормление (разная среда/объём на контейнер)
- [x] Пассаж Step 4 — переработан по паттерну создания культуры (списание со склада, расчёт сред)
- [x] Утилизация — контаминация badge, авто-привязка, предзаполнение причины
- [x] Чистка справочников — морфологии (5), причины утилизации (8)
- [x] Чистка тестовых данных — удалены все донации, культуры, операции

---

## Фаза 15: Упрощение контейнеров, компоненты, позиции ✅

- [x] БД: нормализация equipment.type, создание 15 позиций инкубаторов
- [x] Контейнеры: единый выбор со склада (1 Select → авто-списание)
- [x] Пассаж: расчёт клеток/см², инкубатор dropdown, индивидуальная среда/компоненты
- [x] Создание культуры: контейнер со склада, индивидуальная среда, компоненты
- [x] Кормление: дополнительные компоненты (сыворотка, реагенты, добавки)

## Фаза 16: Тестирование полного цикла ✅

- [x] Генерация кодов контейнеров — исправлена коллизия UUID-подстрок (409 Conflict)
- [x] ReferenceError в форме пассажа — переменная использована до объявления
- [x] Редактирование складских позиций — inline edit form на inventory/[id]
- [x] Чистка осиротевших данных в БД после неудачного пассажа

## Фаза 17: Мониторинг оборудования, справочники, складской учёт ✅

- [x] Схема мониторинга оборудования (equipment_monitoring_params, equipment_logs extended)
- [x] Справочники: все 10 таблиц перезаполнены через Management API (UTF-8)
- [x] Оборудование: формы, карточки, списки — inventory_number, мониторинг-модаль
- [x] Багфикс: пассаж — списание контейнеров и ВСЕХ сред со склада
- [x] Багфикс: заморозка — списание среды заморозки и криовиалов
- [x] Багфикс: разморозка — списание среды разморозки и контейнера
- [x] TypeScript: 0 ошибок

## В процессе

- [ ] E2E: Донор → Донация → Культура → Пассаж → Банк → Выдача
- [ ] Vercel деплой продакшен

---

## Backlog

- [ ] Списание сред и контейнеров при создании первичной культуры (операция SEED)
- [ ] QR-коды — генерация и печать этикеток
- [ ] Графики в Culture Passport
- [ ] RBAC — RLS по ролям
- [ ] Real-time подписки
- [ ] PWA / офлайн-режим
